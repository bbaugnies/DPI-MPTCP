// This file was automatically generated by bifcl from /home/benjamin/Bro/bro-2.3.1/src/file_analysis/analyzer/extract/functions.bif (plugin mode).


#include "functions.bif.h"


#line 5 "functions.bif"

#include "file_analysis/Manager.h"

#line 10 "functions.bif"
Val* BifFunc::FileExtract::bro___set_limit(Frame* frame, val_list* BiF_ARGS)
    
#line 11 "functions.bif"
{
	if ( BiF_ARGS->length() != 3 )
		{
		reporter->Error("FileExtract::__set_limit() takes exactly 3 argument(s)");
		return 0;
		}
	StringVal* file_id = (StringVal*) ((*BiF_ARGS)[0]->AsStringVal());
	Val* args = (Val*) ((*BiF_ARGS)[1]);
	bro_uint_t n = (bro_uint_t) ((*BiF_ARGS)[2]->AsCount());

#line 11 "functions.bif"

	using BifType::Record::Files::AnalyzerArgs;
	RecordVal* rv = args->AsRecordVal()->CoerceTo(AnalyzerArgs);
    bool result = file_mgr->SetExtractionLimit(file_id->CheckString(), rv, n);
	Unref(rv);
    return new Val(result, TYPE_BOOL);
    } // end of BifFunc::FileExtract::bro___set_limit

#line 17 "functions.bif"
