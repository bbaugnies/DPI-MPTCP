


\chapter{Conclusion} \label{chap:conclusion}
This concludes our work on Deep Packet Inspection with Multipath TCP. As we have seen, the development and deployment of a new protocol is not limited to conceptualizing it and implementing it. For a protocol to achieve large scale success on today's internet, compliance with commonly used networking tools is just as important as good design. In addition to the common challenges of creating a new protocol, our overview of MPTCP has shown that this protocol in particular brings about new challenges that break many common assumptions on modern networks.\\

In an effort to improve existing tools to work with MPTCP, we have presented the Bro IDS, a powerful and flexible tool for network analysis and intrusion detection. By explaining how the system functions, we exposed which parts needed to be worked on in order to allow Bro to understand and produce meaningful results with MPTCP. We discussed the two main components of Bro: the Engine and the Script Interpreter. The Event Engine which parses packets to raise events has been modified in order to transfer the binary MPTCP information contained in the TCP options to the powerful Policy Script Interpreter, and to do so in an easily understandable manner. With the new events being raised, we have been able to produce scripts which can exploit the information in order to showcase important behavior within the protocol. While presenting the scripts, we outlined potential attacks that may be used in the future against the protocol. \\

We then discussed why these changes were not sufficient. While detecting anomalies in the behavior of the protocol has its uses, it is crucial to allow Bro to run its full set of analyzers on the data stream, and not on bits and pieces. In order to make this possible, we have provided an explanation of how Bro performs TCP reassembly. Once the mechanisms were understood, we endeavored to conceive a method which would allow Bro to reassemble data from multiple subflows into a single, ordered stream. This, in turn, would allow all the existing protocol analyzers to run their course, thoroughly examining the connection's payload.\\

Through these efforts, we hope to pave the way for a successful MPTCP reassembly implementation within an IDS. The success of such an implementation would enable us to detect threats even if they were split over multiple TCP connections. Being able to do so is an important part of the evolution and continued development of security tools for Multipath TCP.